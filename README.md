
# HIVdb Tools

The main purpose of these programs is to organize and extract relevant information generated from HIV-1 PR, RT, and IN amplicons. These programs were designed to work specifically with an HIV1-Resistance study for Dr. Jeanne Jordan's Lab, working under the DC Cohort sponsored by NIAID-NIH(U01 AI69503-03S2).

### Prerequisites

 - Perl-5.22.1 or later (https://www.perl.org/get.html)
 - Python 3.5.2 or later  (https://www.python.org/downloads/release/python-352/)
 - Unix Based OS: Written on Ubuntu 16.04 LTS (https://www.ubuntu.com/download/desktop), but it will also work fine for Mac OS as well.
 
 To check the current version of the software you currently have. Run the following commands:
 For Perl
 
    perl -v

For Python

    python --version

If you discover that your versions are earlier (lower number than) the versions listed above. Follow the respective link fro instructions on how to obtain the correct versions.

For each procedural task listed below. You must have a Terminal opened up to run commands through command line. You can achieve this by using the short-key: "Ctrl+Alt+t". Alternatively, you can also search for "Terminal" in your Linux/Unix taskbar. 

When inside the terminal, the directory you start out in is called your "Home Directory" and this is where all of the programs and input files should be before execution. 
## hivdb_organize.py
This program separates PR, RT, and IN gene regions into their own FASTA files for use in further analysis.

### Getting Started:
First, you will need to have a multi-fasta for the consensus sequences of your samples. This can be obtained from downloading the consensus sequences generated by your aligner of choice. I decided to use the consensus sequences provided by [HyDRA-Web](https://hydra.canada.ca/).

When opening the file, it should look similar to the sample-file listed below:

```
>Sample1
GCATGCATGCT
>Sample2
ACGTAGCTAGC
>Sample3
GTAGCTAGTGT
...
```

Next, we will need to edit this file to make it easilly readable for the program. Do do this you will have to make a "sampleList.txt" file that holds all of your sequence headers without the ">". To do this you will need to use this Perl one-liner to quickly make the file. In the terminal command line, run the following command:

```
perl -ne 'if(/^>(.+)/){print"$1\n";}' my_consensuses.fasta > sampleList.txt
```

You have now created a sampleList file that can be used by the program! All that is left is to run the program. Making sure that sampleList and hivdb_organize.py are in the same folder, run the following command:
### Usage:

```
python3 ./hivdb_organize.py
```

### Output:

After running the command, you will find multiple multi-fasta files created from this program if the respective gene regions are found:
```
AllPR.fasta
AllRT.fasta
AllIN.fasta
AllPR_RT.fasta
AllRT_IN.fasta
AllReigons.fasta
```

## hivdb_extract.py
Using a [HyDRA](https://hydra.canada.ca/)  Mutation-Report file, this program extracts amino acid mutations and separates them into individual files for input into the [Stanford HIVdb Program](https://hivdb.stanford.edu/hivdb/by-mutations/).

### Getting Started:
When using HyDRA, you have the option to "download report" after the main analysis has finished. To begin, you will need to have this Mutation-Report file (.csv) ready.  This file will come in the .csv format and should look similar to this when opened in a notepad:
```
PL-16,RT,NNRTI,No,V,108,I,15.03,1071
PL-93,PR,Accessory,No,L,10,F,15.41,1382
PL-73,RT,NRTI,Yes,M,184,V,15.42,10459
PL-77,RT,NRTI,Yes,M,184,V,15.59,5473
PL-16,RT,NNRTI,No,L,100,V,16.13,998
```
You will need to run the commands for this program through a Terminal command-line. This can be opened the short-key Ctrl+Alt+t. This will bring up the terminal to take in user commands. You must also make sure that the program and the input file (Mutation-Report.csv) are in the same directory before starting. 
### Usage
```
python3 ./hivdb_extract.py
```

### Output
After running, there will be a Variant file (.txt) made for each sample containing a relevant mutation. To evaluate in the Stanford HIVdb, you will have to copy and paste each section into their respective text box:

Variant_1.txt
```
RT
V90I
S68G

PR
A71T

IN
L74I
```

## Authors

**Harrison Reed** - *Initial work* - [HReed1](https://github.com/HReed1)

